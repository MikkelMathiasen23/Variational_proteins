/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
  warnings.warn(
2021-04-29 18:19:34,220	INFO services.py:1267 -- View the Ray dashboard at [1m[32mhttp://127.0.0.1:8265[39m[22m
2021-04-29 18:19:44,547	WARNING function_runner.py:544 -- Function checkpointing is disabled. This may result in unexpected behavior when using checkpointing features or certain schedulers. To enable, set the train function arguments to be `func(config, checkpoint_dir=None)`.
[2m[36m(pid=24777)[0m 2021-04-29 23:17:56,495	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=24777)[0m Traceback (most recent call last):
[2m[36m(pid=24777)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=24777)[0m     self._entrypoint()
[2m[36m(pid=24777)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=24777)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=24777)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=24777)[0m     output = fn()
[2m[36m(pid=24777)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=24777)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=24777)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=24777)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=24777)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=24777)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=24777)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=24777)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=24777)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=24777)[0m Exception in thread Thread-2:
[2m[36m(pid=24777)[0m Traceback (most recent call last):
[2m[36m(pid=24777)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=24777)[0m     self.run()
[2m[36m(pid=24777)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=24777)[0m     raise e
[2m[36m(pid=24777)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=24777)[0m     self._entrypoint()
[2m[36m(pid=24777)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=24777)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=24777)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=24777)[0m     output = fn()
[2m[36m(pid=24777)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=24777)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=24777)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=24777)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=24777)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=24777)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=24777)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=24777)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=24777)[0m ValueError: The parameter loc has invalid values
2021-04-29 23:17:56,641	ERROR trial_runner.py:732 -- Trial train_func_b589c_00020: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=24777, ip=10.66.20.6)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=24777, ip=10.66.20.6)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "gridsearch_ray_tune.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
User defined signal 2
