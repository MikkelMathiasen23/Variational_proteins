/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
  warnings.warn(
2021-04-30 09:53:37,370	INFO services.py:1267 -- View the Ray dashboard at [1m[32mhttp://127.0.0.1:8265[39m[22m
2021-04-30 09:53:53,062	WARNING function_runner.py:544 -- Function checkpointing is disabled. This may result in unexpected behavior when using checkpointing features or certain schedulers. To enable, set the train function arguments to be `func(config, checkpoint_dir=None)`.
[2m[36m(pid=36986)[0m 2021-04-30 15:03:41,001	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=36986)[0m Traceback (most recent call last):
[2m[36m(pid=36986)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=36986)[0m     self._entrypoint()
[2m[36m(pid=36986)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=36986)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=36986)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=36986)[0m     output = fn()
[2m[36m(pid=36986)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=36986)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=36986)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=36986)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=36986)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=36986)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=36986)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=36986)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=36986)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=36986)[0m Exception in thread Thread-2:
[2m[36m(pid=36986)[0m Traceback (most recent call last):
[2m[36m(pid=36986)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=36986)[0m     self.run()
[2m[36m(pid=36986)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=36986)[0m     raise e
[2m[36m(pid=36986)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=36986)[0m     self._entrypoint()
[2m[36m(pid=36986)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=36986)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=36986)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=36986)[0m     output = fn()
[2m[36m(pid=36986)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=36986)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=36986)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=36986)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=36986)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=36986)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=36986)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=36986)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=36986)[0m ValueError: The parameter loc has invalid values
2021-04-30 15:03:41,050	ERROR trial_runner.py:732 -- Trial train_func_350e9_00021: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=36986, ip=10.66.20.7)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=36986, ip=10.66.20.7)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "gridsearch_ray_tune.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[36m(pid=36996)[0m 2021-04-30 15:20:29,053	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=36996)[0m Traceback (most recent call last):
[2m[36m(pid=36996)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=36996)[0m     self._entrypoint()
[2m[36m(pid=36996)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=36996)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=36996)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=36996)[0m     output = fn()
[2m[36m(pid=36996)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=36996)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=36996)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=36996)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=36996)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=36996)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=36996)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=36996)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=36996)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=36996)[0m Exception in thread Thread-2:
[2m[36m(pid=36996)[0m Traceback (most recent call last):
[2m[36m(pid=36996)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=36996)[0m     self.run()
[2m[36m(pid=36996)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=36996)[0m     raise e
[2m[36m(pid=36996)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=36996)[0m     self._entrypoint()
[2m[36m(pid=36996)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=36996)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=36996)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=36996)[0m     output = fn()
[2m[36m(pid=36996)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=36996)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=36996)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=36996)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=36996)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=36996)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=36996)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=36996)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=36996)[0m ValueError: The parameter loc has invalid values
2021-04-30 15:20:29,120	ERROR trial_runner.py:732 -- Trial train_func_350e9_00023: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=36996, ip=10.66.20.7)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=36996, ip=10.66.20.7)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "gridsearch_ray_tune.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
2021-04-30 17:01:38,722	ERROR trial_runner.py:732 -- Trial train_func_350e9_00031: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=36974, ip=10.66.20.7)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=36974, ip=10.66.20.7)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "gridsearch_ray_tune.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[36m(pid=36974)[0m 2021-04-30 17:01:38,670	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=36974)[0m Traceback (most recent call last):
[2m[36m(pid=36974)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=36974)[0m     self._entrypoint()
[2m[36m(pid=36974)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=36974)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=36974)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=36974)[0m     output = fn()
[2m[36m(pid=36974)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=36974)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=36974)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=36974)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=36974)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=36974)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=36974)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=36974)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=36974)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=36974)[0m Exception in thread Thread-2:
[2m[36m(pid=36974)[0m Traceback (most recent call last):
[2m[36m(pid=36974)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=36974)[0m     self.run()
[2m[36m(pid=36974)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=36974)[0m     raise e
[2m[36m(pid=36974)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=36974)[0m     self._entrypoint()
[2m[36m(pid=36974)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=36974)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=36974)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=36974)[0m     output = fn()
[2m[36m(pid=36974)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=36974)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=36974)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=36974)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=36974)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=36974)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=36974)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=36974)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=36974)[0m ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
2021-04-30 20:49:42,856	ERROR trial_runner.py:732 -- Trial train_func_350e9_00049: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=28230, ip=10.66.20.7)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=28230, ip=10.66.20.7)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "gridsearch_ray_tune.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[36m(pid=28230)[0m 2021-04-30 20:49:42,822	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=28230)[0m Traceback (most recent call last):
[2m[36m(pid=28230)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=28230)[0m     self._entrypoint()
[2m[36m(pid=28230)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=28230)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=28230)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=28230)[0m     output = fn()
[2m[36m(pid=28230)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=28230)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=28230)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=28230)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=28230)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=28230)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=28230)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=28230)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=28230)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=28230)[0m Exception in thread Thread-2:
[2m[36m(pid=28230)[0m Traceback (most recent call last):
[2m[36m(pid=28230)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=28230)[0m     self.run()
[2m[36m(pid=28230)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=28230)[0m     raise e
[2m[36m(pid=28230)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=28230)[0m     self._entrypoint()
[2m[36m(pid=28230)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=28230)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=28230)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=28230)[0m     output = fn()
[2m[36m(pid=28230)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=28230)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=28230)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=28230)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=28230)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=28230)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=28230)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=28230)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=28230)[0m ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
2021-04-30 21:54:09,880	ERROR trial_runner.py:732 -- Trial train_func_350e9_00054: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=31650, ip=10.66.20.7)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=31650, ip=10.66.20.7)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "gridsearch_ray_tune.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[36m(pid=31650)[0m 2021-04-30 21:54:09,826	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=31650)[0m Traceback (most recent call last):
[2m[36m(pid=31650)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=31650)[0m     self._entrypoint()
[2m[36m(pid=31650)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=31650)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=31650)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=31650)[0m     output = fn()
[2m[36m(pid=31650)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=31650)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=31650)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=31650)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=31650)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=31650)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=31650)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=31650)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=31650)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=31650)[0m Exception in thread Thread-2:
[2m[36m(pid=31650)[0m Traceback (most recent call last):
[2m[36m(pid=31650)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=31650)[0m     self.run()
[2m[36m(pid=31650)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=31650)[0m     raise e
[2m[36m(pid=31650)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=31650)[0m     self._entrypoint()
[2m[36m(pid=31650)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=31650)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=31650)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=31650)[0m     output = fn()
[2m[36m(pid=31650)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=31650)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=31650)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=31650)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=31650)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=31650)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=31650)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=31650)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=31650)[0m ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=35534)[0m 2021-04-30 22:50:29,303	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=35534)[0m Traceback (most recent call last):
[2m[36m(pid=35534)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=35534)[0m     self._entrypoint()
[2m[36m(pid=35534)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=35534)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=35534)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=35534)[0m     output = fn()
[2m[36m(pid=35534)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=35534)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=35534)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=35534)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=35534)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=35534)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=35534)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=35534)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=35534)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=35534)[0m Exception in thread Thread-2:
[2m[36m(pid=35534)[0m Traceback (most recent call last):
[2m[36m(pid=35534)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=35534)[0m     self.run()
[2m[36m(pid=35534)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=35534)[0m     raise e
[2m[36m(pid=35534)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=35534)[0m     self._entrypoint()
[2m[36m(pid=35534)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=35534)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=35534)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=35534)[0m     output = fn()
[2m[36m(pid=35534)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=35534)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=35534)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=35534)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=35534)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=35534)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=35534)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=35534)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=35534)[0m ValueError: The parameter loc has invalid values
2021-04-30 22:50:29,410	ERROR trial_runner.py:732 -- Trial train_func_350e9_00059: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=35534, ip=10.66.20.7)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=35534, ip=10.66.20.7)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "gridsearch_ray_tune.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=44047)[0m 2021-05-01 01:06:15,944	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=44047)[0m Traceback (most recent call last):
[2m[36m(pid=44047)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=44047)[0m     self._entrypoint()
[2m[36m(pid=44047)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=44047)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=44047)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=44047)[0m     output = fn()
[2m[36m(pid=44047)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=44047)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=44047)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=44047)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=44047)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=44047)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=44047)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=44047)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=44047)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=44047)[0m Exception in thread Thread-2:
[2m[36m(pid=44047)[0m Traceback (most recent call last):
[2m[36m(pid=44047)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=44047)[0m     self.run()
[2m[36m(pid=44047)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=44047)[0m     raise e
[2m[36m(pid=44047)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=44047)[0m     self._entrypoint()
[2m[36m(pid=44047)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=44047)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=44047)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=44047)[0m     output = fn()
[2m[36m(pid=44047)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=44047)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=44047)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=44047)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=44047)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=44047)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=44047)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=44047)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=44047)[0m ValueError: The parameter loc has invalid values
2021-05-01 01:06:16,154	ERROR trial_runner.py:732 -- Trial train_func_350e9_00070: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=44047, ip=10.66.20.7)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=44047, ip=10.66.20.7)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "gridsearch_ray_tune.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=47407)[0m 2021-05-01 02:02:54,362	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=47407)[0m Traceback (most recent call last):
[2m[36m(pid=47407)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=47407)[0m     self._entrypoint()
[2m[36m(pid=47407)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=47407)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=47407)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=47407)[0m     output = fn()
[2m[36m(pid=47407)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=47407)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=47407)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=47407)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=47407)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=47407)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=47407)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=47407)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=47407)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=47407)[0m Exception in thread Thread-2:
[2m[36m(pid=47407)[0m Traceback (most recent call last):
[2m[36m(pid=47407)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=47407)[0m     self.run()
[2m[36m(pid=47407)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=47407)[0m     raise e
[2m[36m(pid=47407)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=47407)[0m     self._entrypoint()
[2m[36m(pid=47407)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=47407)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=47407)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=47407)[0m     output = fn()
[2m[36m(pid=47407)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=47407)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=47407)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=47407)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=47407)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=47407)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=47407)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=47407)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=47407)[0m ValueError: The parameter loc has invalid values
2021-05-01 02:02:54,590	ERROR trial_runner.py:732 -- Trial train_func_350e9_00075: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=47407, ip=10.66.20.7)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=47407, ip=10.66.20.7)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "gridsearch_ray_tune.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=48434)[0m 2021-05-01 02:24:14,568	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=48434)[0m Traceback (most recent call last):
[2m[36m(pid=48434)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=48434)[0m     self._entrypoint()
[2m[36m(pid=48434)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=48434)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=48434)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=48434)[0m     output = fn()
[2m[36m(pid=48434)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=48434)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=48434)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=48434)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=48434)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=48434)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=48434)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=48434)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=48434)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=48434)[0m Exception in thread Thread-2:
[2m[36m(pid=48434)[0m Traceback (most recent call last):
[2m[36m(pid=48434)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=48434)[0m     self.run()
[2m[36m(pid=48434)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=48434)[0m     raise e
[2m[36m(pid=48434)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=48434)[0m     self._entrypoint()
[2m[36m(pid=48434)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=48434)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=48434)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=48434)[0m     output = fn()
[2m[36m(pid=48434)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=48434)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=48434)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=48434)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=48434)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=48434)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=48434)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=48434)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=48434)[0m ValueError: The parameter loc has invalid values
2021-05-01 02:24:14,760	ERROR trial_runner.py:732 -- Trial train_func_350e9_00077: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=48434, ip=10.66.20.7)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=48434, ip=10.66.20.7)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "gridsearch_ray_tune.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=2719)[0m 2021-05-01 03:06:28,390	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=2719)[0m Traceback (most recent call last):
[2m[36m(pid=2719)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=2719)[0m     self._entrypoint()
[2m[36m(pid=2719)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=2719)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=2719)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=2719)[0m     output = fn()
[2m[36m(pid=2719)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=2719)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=2719)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=2719)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=2719)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=2719)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=2719)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=2719)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=2719)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=2719)[0m Exception in thread Thread-2:
[2m[36m(pid=2719)[0m Traceback (most recent call last):
[2m[36m(pid=2719)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=2719)[0m     self.run()
[2m[36m(pid=2719)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=2719)[0m     raise e
[2m[36m(pid=2719)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=2719)[0m     self._entrypoint()
[2m[36m(pid=2719)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=2719)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=2719)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=2719)[0m     output = fn()
[2m[36m(pid=2719)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=2719)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=2719)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=2719)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=2719)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=2719)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=2719)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=2719)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=2719)[0m ValueError: The parameter loc has invalid values
2021-05-01 03:06:28,450	ERROR trial_runner.py:732 -- Trial train_func_350e9_00081: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=2719, ip=10.66.20.7)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=2719, ip=10.66.20.7)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "gridsearch_ray_tune.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=2845)[0m 2021-05-01 03:08:38,962	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=2845)[0m Traceback (most recent call last):
[2m[36m(pid=2845)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=2845)[0m     self._entrypoint()
[2m[36m(pid=2845)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=2845)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=2845)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=2845)[0m     output = fn()
[2m[36m(pid=2845)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=2845)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=2845)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=2845)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=2845)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=2845)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=2845)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=2845)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=2845)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=2845)[0m Exception in thread Thread-2:
[2m[36m(pid=2845)[0m Traceback (most recent call last):
[2m[36m(pid=2845)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=2845)[0m     self.run()
[2m[36m(pid=2845)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=2845)[0m     raise e
[2m[36m(pid=2845)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=2845)[0m     self._entrypoint()
[2m[36m(pid=2845)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=2845)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=2845)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=2845)[0m     output = fn()
[2m[36m(pid=2845)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=2845)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=2845)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=2845)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=2845)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=2845)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=2845)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=2845)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=2845)[0m ValueError: The parameter loc has invalid values
2021-05-01 03:08:39,008	ERROR trial_runner.py:732 -- Trial train_func_350e9_00082: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=2845, ip=10.66.20.7)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=2845, ip=10.66.20.7)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "gridsearch_ray_tune.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=3832)[0m 2021-05-01 03:22:46,465	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=3832)[0m Traceback (most recent call last):
[2m[36m(pid=3832)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=3832)[0m     self._entrypoint()
[2m[36m(pid=3832)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=3832)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=3832)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=3832)[0m     output = fn()
[2m[36m(pid=3832)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=3832)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=3832)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=3832)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=3832)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=3832)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=3832)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=3832)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=3832)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=3832)[0m Exception in thread Thread-2:
[2m[36m(pid=3832)[0m Traceback (most recent call last):
[2m[36m(pid=3832)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=3832)[0m     self.run()
[2m[36m(pid=3832)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=3832)[0m     raise e
[2m[36m(pid=3832)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=3832)[0m     self._entrypoint()
[2m[36m(pid=3832)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=3832)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=3832)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=3832)[0m     output = fn()
[2m[36m(pid=3832)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=3832)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=3832)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=3832)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=3832)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=3832)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=3832)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=3832)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=3832)[0m ValueError: The parameter loc has invalid values
2021-05-01 03:22:46,522	ERROR trial_runner.py:732 -- Trial train_func_350e9_00084: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=3832, ip=10.66.20.7)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=3832, ip=10.66.20.7)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "gridsearch_ray_tune.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=5518)[0m 2021-05-01 03:54:03,162	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=5518)[0m Traceback (most recent call last):
[2m[36m(pid=5518)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=5518)[0m     self._entrypoint()
[2m[36m(pid=5518)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=5518)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=5518)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=5518)[0m     output = fn()
[2m[36m(pid=5518)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=5518)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=5518)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=5518)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=5518)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=5518)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=5518)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=5518)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=5518)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=5518)[0m Exception in thread Thread-2:
[2m[36m(pid=5518)[0m Traceback (most recent call last):
[2m[36m(pid=5518)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=5518)[0m     self.run()
[2m[36m(pid=5518)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=5518)[0m     raise e
[2m[36m(pid=5518)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=5518)[0m     self._entrypoint()
[2m[36m(pid=5518)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=5518)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=5518)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=5518)[0m     output = fn()
[2m[36m(pid=5518)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=5518)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=5518)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=5518)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=5518)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=5518)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=5518)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=5518)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=5518)[0m ValueError: The parameter loc has invalid values
2021-05-01 03:54:03,293	ERROR trial_runner.py:732 -- Trial train_func_350e9_00087: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=5518, ip=10.66.20.7)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=5518, ip=10.66.20.7)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "gridsearch_ray_tune.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=7471)[0m 2021-05-01 04:21:59,918	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=7471)[0m Traceback (most recent call last):
[2m[36m(pid=7471)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=7471)[0m     self._entrypoint()
[2m[36m(pid=7471)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=7471)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=7471)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=7471)[0m     output = fn()
[2m[36m(pid=7471)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=7471)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=7471)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=7471)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=7471)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=7471)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=7471)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=7471)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=7471)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=7471)[0m Exception in thread Thread-2:
[2m[36m(pid=7471)[0m Traceback (most recent call last):
[2m[36m(pid=7471)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=7471)[0m     self.run()
[2m[36m(pid=7471)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=7471)[0m     raise e
[2m[36m(pid=7471)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=7471)[0m     self._entrypoint()
[2m[36m(pid=7471)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=7471)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=7471)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=7471)[0m     output = fn()
[2m[36m(pid=7471)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=7471)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=7471)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=7471)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=7471)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=7471)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=7471)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=7471)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=7471)[0m ValueError: The parameter loc has invalid values
2021-05-01 04:22:00,113	ERROR trial_runner.py:732 -- Trial train_func_350e9_00090: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=7471, ip=10.66.20.7)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=7471, ip=10.66.20.7)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "gridsearch_ray_tune.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=11675)[0m 2021-05-01 05:31:13,105	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=11675)[0m Traceback (most recent call last):
[2m[36m(pid=11675)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=11675)[0m     self._entrypoint()
[2m[36m(pid=11675)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=11675)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=11675)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=11675)[0m     output = fn()
[2m[36m(pid=11675)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=11675)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=11675)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=11675)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=11675)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=11675)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=11675)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=11675)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=11675)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=11675)[0m Exception in thread Thread-2:
[2m[36m(pid=11675)[0m Traceback (most recent call last):
[2m[36m(pid=11675)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=11675)[0m     self.run()
[2m[36m(pid=11675)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=11675)[0m     raise e
[2m[36m(pid=11675)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=11675)[0m     self._entrypoint()
[2m[36m(pid=11675)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=11675)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=11675)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=11675)[0m     output = fn()
[2m[36m(pid=11675)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=11675)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=11675)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=11675)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=11675)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=11675)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=11675)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=11675)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=11675)[0m ValueError: The parameter loc has invalid values
2021-05-01 05:31:13,165	ERROR trial_runner.py:732 -- Trial train_func_350e9_00096: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=11675, ip=10.66.20.7)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=11675, ip=10.66.20.7)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "gridsearch_ray_tune.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=16712)[0m 2021-05-01 06:58:49,451	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=16712)[0m Traceback (most recent call last):
[2m[36m(pid=16712)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=16712)[0m     self._entrypoint()
[2m[36m(pid=16712)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=16712)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=16712)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=16712)[0m     output = fn()
[2m[36m(pid=16712)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=16712)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=16712)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=16712)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=16712)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=16712)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=16712)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=16712)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=16712)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=16712)[0m Exception in thread Thread-2:
[2m[36m(pid=16712)[0m Traceback (most recent call last):
[2m[36m(pid=16712)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=16712)[0m     self.run()
[2m[36m(pid=16712)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=16712)[0m     raise e
[2m[36m(pid=16712)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=16712)[0m     self._entrypoint()
[2m[36m(pid=16712)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=16712)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=16712)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=16712)[0m     output = fn()
[2m[36m(pid=16712)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=16712)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=16712)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=16712)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=16712)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=16712)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=16712)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=16712)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=16712)[0m ValueError: The parameter loc has invalid values
2021-05-01 06:58:49,532	ERROR trial_runner.py:732 -- Trial train_func_350e9_00103: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=16712, ip=10.66.20.7)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=16712, ip=10.66.20.7)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "gridsearch_ray_tune.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=17952)[0m 2021-05-01 07:13:51,418	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=17952)[0m Traceback (most recent call last):
[2m[36m(pid=17952)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=17952)[0m     self._entrypoint()
[2m[36m(pid=17952)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=17952)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=17952)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=17952)[0m     output = fn()
[2m[36m(pid=17952)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=17952)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=17952)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=17952)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=17952)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=17952)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=17952)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=17952)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=17952)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=17952)[0m Exception in thread Thread-2:
[2m[36m(pid=17952)[0m Traceback (most recent call last):
[2m[36m(pid=17952)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=17952)[0m     self.run()
[2m[36m(pid=17952)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=17952)[0m     raise e
[2m[36m(pid=17952)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=17952)[0m     self._entrypoint()
[2m[36m(pid=17952)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=17952)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=17952)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=17952)[0m     output = fn()
[2m[36m(pid=17952)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=17952)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=17952)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=17952)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=17952)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=17952)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=17952)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=17952)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=17952)[0m ValueError: The parameter loc has invalid values
2021-05-01 07:13:51,544	ERROR trial_runner.py:732 -- Trial train_func_350e9_00105: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=17952, ip=10.66.20.7)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=17952, ip=10.66.20.7)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "gridsearch_ray_tune.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=19058)[0m 2021-05-01 07:28:14,232	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=19058)[0m Traceback (most recent call last):
[2m[36m(pid=19058)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=19058)[0m     self._entrypoint()
[2m[36m(pid=19058)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=19058)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=19058)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=19058)[0m     output = fn()
[2m[36m(pid=19058)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=19058)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=19058)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=19058)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=19058)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=19058)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=19058)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=19058)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=19058)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=19058)[0m Exception in thread Thread-2:
[2m[36m(pid=19058)[0m Traceback (most recent call last):
[2m[36m(pid=19058)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=19058)[0m     self.run()
[2m[36m(pid=19058)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=19058)[0m     raise e
[2m[36m(pid=19058)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=19058)[0m     self._entrypoint()
[2m[36m(pid=19058)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=19058)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=19058)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=19058)[0m     output = fn()
[2m[36m(pid=19058)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=19058)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=19058)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=19058)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=19058)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=19058)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=19058)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=19058)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=19058)[0m ValueError: The parameter loc has invalid values
2021-05-01 07:28:14,337	ERROR trial_runner.py:732 -- Trial train_func_350e9_00107: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=19058, ip=10.66.20.7)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=19058, ip=10.66.20.7)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "gridsearch_ray_tune.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=24214)[0m 2021-05-01 08:52:54,515	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=24214)[0m Traceback (most recent call last):
[2m[36m(pid=24214)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=24214)[0m     self._entrypoint()
[2m[36m(pid=24214)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=24214)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=24214)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=24214)[0m     output = fn()
[2m[36m(pid=24214)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=24214)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=24214)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=24214)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=24214)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=24214)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=24214)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=24214)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=24214)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=24214)[0m Exception in thread Thread-2:
[2m[36m(pid=24214)[0m Traceback (most recent call last):
[2m[36m(pid=24214)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=24214)[0m     self.run()
[2m[36m(pid=24214)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=24214)[0m     raise e
[2m[36m(pid=24214)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=24214)[0m     self._entrypoint()
[2m[36m(pid=24214)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=24214)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=24214)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=24214)[0m     output = fn()
[2m[36m(pid=24214)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=24214)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=24214)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=24214)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=24214)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=24214)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=24214)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=24214)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=24214)[0m ValueError: The parameter loc has invalid values
2021-05-01 08:52:54,591	ERROR trial_runner.py:732 -- Trial train_func_350e9_00114: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=24214, ip=10.66.20.7)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=24214, ip=10.66.20.7)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "gridsearch_ray_tune.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=24318)[0m 2021-05-01 08:54:42,729	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=24318)[0m Traceback (most recent call last):
[2m[36m(pid=24318)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=24318)[0m     self._entrypoint()
[2m[36m(pid=24318)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=24318)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=24318)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=24318)[0m     output = fn()
[2m[36m(pid=24318)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=24318)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=24318)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=24318)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=24318)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=24318)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=24318)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=24318)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=24318)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=24318)[0m Exception in thread Thread-2:
[2m[36m(pid=24318)[0m Traceback (most recent call last):
[2m[36m(pid=24318)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=24318)[0m     self.run()
[2m[36m(pid=24318)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=24318)[0m     raise e
[2m[36m(pid=24318)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=24318)[0m     self._entrypoint()
[2m[36m(pid=24318)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=24318)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=24318)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=24318)[0m     output = fn()
[2m[36m(pid=24318)[0m   File "gridsearch_ray_tune.py", line 94, in train_func
[2m[36m(pid=24318)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
[2m[36m(pid=24318)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=24318)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=24318)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=24318)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=24318)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=24318)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=24318)[0m ValueError: The parameter loc has invalid values
2021-05-01 08:54:42,768	ERROR trial_runner.py:732 -- Trial train_func_350e9_00115: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=24318, ip=10.66.20.7)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=24318, ip=10.66.20.7)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "gridsearch_ray_tune.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
2021-05-01 09:07:37,643	ERROR trial_runner.py:732 -- Trial train_func_350e9_00116: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=24446, ip=10.66.20.7)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=24446, ip=10.66.20.7)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "gridsearch_ray_tune.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =1)
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
User defined signal 2
