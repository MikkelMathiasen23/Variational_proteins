/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
  warnings.warn(
2021-04-30 09:48:21,451	INFO services.py:1267 -- View the Ray dashboard at [1m[32mhttp://127.0.0.1:8265[39m[22m
2021-04-30 09:48:31,853	WARNING function_runner.py:544 -- Function checkpointing is disabled. This may result in unexpected behavior when using checkpointing features or certain schedulers. To enable, set the train function arguments to be `func(config, checkpoint_dir=None)`.
[2m[36m(pid=13036)[0m 2021-04-30 14:25:32,148	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=13036)[0m Traceback (most recent call last):
[2m[36m(pid=13036)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=13036)[0m     self._entrypoint()
[2m[36m(pid=13036)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=13036)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=13036)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=13036)[0m     output = fn()
[2m[36m(pid=13036)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=13036)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=13036)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=13036)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=13036)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=13036)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=13036)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=13036)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=13036)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=13036)[0m Exception in thread Thread-2:
[2m[36m(pid=13036)[0m Traceback (most recent call last):
[2m[36m(pid=13036)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=13036)[0m     self.run()
[2m[36m(pid=13036)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=13036)[0m     raise e
[2m[36m(pid=13036)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=13036)[0m     self._entrypoint()
[2m[36m(pid=13036)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=13036)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=13036)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=13036)[0m     output = fn()
[2m[36m(pid=13036)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=13036)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=13036)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=13036)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=13036)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=13036)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=13036)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=13036)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=13036)[0m ValueError: The parameter loc has invalid values
2021-04-30 14:25:32,714	ERROR trial_runner.py:732 -- Trial train_func_7599e_00018: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=13036, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=13036, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[36m(pid=13033)[0m 2021-04-30 14:57:54,567	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=13033)[0m Traceback (most recent call last):
[2m[36m(pid=13033)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=13033)[0m     self._entrypoint()
[2m[36m(pid=13033)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=13033)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=13033)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=13033)[0m     output = fn()
[2m[36m(pid=13033)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=13033)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=13033)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=13033)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=13033)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=13033)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=13033)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=13033)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=13033)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=13033)[0m Exception in thread Thread-2:
[2m[36m(pid=13033)[0m Traceback (most recent call last):
[2m[36m(pid=13033)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=13033)[0m     self.run()
[2m[36m(pid=13033)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=13033)[0m     raise e
[2m[36m(pid=13033)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=13033)[0m     self._entrypoint()
[2m[36m(pid=13033)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=13033)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=13033)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=13033)[0m     output = fn()
[2m[36m(pid=13033)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=13033)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=13033)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=13033)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=13033)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=13033)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=13033)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=13033)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=13033)[0m ValueError: The parameter loc has invalid values
2021-04-30 14:57:54,651	ERROR trial_runner.py:732 -- Trial train_func_7599e_00021: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=13033, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=13033, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[36m(pid=13032)[0m 2021-04-30 15:12:31,669	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=13032)[0m Traceback (most recent call last):
[2m[36m(pid=13032)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=13032)[0m     self._entrypoint()
[2m[36m(pid=13032)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=13032)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=13032)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=13032)[0m     output = fn()
[2m[36m(pid=13032)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=13032)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=13032)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=13032)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=13032)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=13032)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=13032)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=13032)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=13032)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=13032)[0m Exception in thread Thread-2:
[2m[36m(pid=13032)[0m Traceback (most recent call last):
[2m[36m(pid=13032)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=13032)[0m     self.run()
[2m[36m(pid=13032)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=13032)[0m     raise e
[2m[36m(pid=13032)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=13032)[0m     self._entrypoint()
[2m[36m(pid=13032)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=13032)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=13032)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=13032)[0m     output = fn()
[2m[36m(pid=13032)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=13032)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=13032)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=13032)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=13032)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=13032)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=13032)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=13032)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=13032)[0m ValueError: The parameter loc has invalid values
2021-04-30 15:12:31,738	ERROR trial_runner.py:732 -- Trial train_func_7599e_00023: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=13032, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=13032, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=9371)[0m 2021-04-30 16:10:03,215	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=9371)[0m Traceback (most recent call last):
[2m[36m(pid=9371)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=9371)[0m     self._entrypoint()
[2m[36m(pid=9371)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=9371)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=9371)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=9371)[0m     output = fn()
[2m[36m(pid=9371)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=9371)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=9371)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=9371)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=9371)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=9371)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=9371)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=9371)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=9371)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=9371)[0m Exception in thread Thread-2:
[2m[36m(pid=9371)[0m Traceback (most recent call last):
[2m[36m(pid=9371)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=9371)[0m     self.run()
[2m[36m(pid=9371)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=9371)[0m     raise e
[2m[36m(pid=9371)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=9371)[0m     self._entrypoint()
[2m[36m(pid=9371)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=9371)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=9371)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=9371)[0m     output = fn()
[2m[36m(pid=9371)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=9371)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=9371)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=9371)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=9371)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=9371)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=9371)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=9371)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=9371)[0m ValueError: The parameter loc has invalid values
2021-04-30 16:10:03,419	ERROR trial_runner.py:732 -- Trial train_func_7599e_00028: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=9371, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=9371, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
2021-04-30 16:53:24,244	ERROR trial_runner.py:732 -- Trial train_func_7599e_00032: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=13334, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=13334, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[36m(pid=13334)[0m 2021-04-30 16:53:24,190	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=13334)[0m Traceback (most recent call last):
[2m[36m(pid=13334)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=13334)[0m     self._entrypoint()
[2m[36m(pid=13334)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=13334)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=13334)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=13334)[0m     output = fn()
[2m[36m(pid=13334)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=13334)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=13334)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=13334)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=13334)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=13334)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=13334)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=13334)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=13334)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=13334)[0m Exception in thread Thread-2:
[2m[36m(pid=13334)[0m Traceback (most recent call last):
[2m[36m(pid=13334)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=13334)[0m     self.run()
[2m[36m(pid=13334)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=13334)[0m     raise e
[2m[36m(pid=13334)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=13334)[0m     self._entrypoint()
[2m[36m(pid=13334)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=13334)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=13334)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=13334)[0m     output = fn()
[2m[36m(pid=13334)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=13334)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=13334)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=13334)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=13334)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=13334)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=13334)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=13334)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=13334)[0m ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=15991)[0m 2021-04-30 17:22:37,540	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=15991)[0m Traceback (most recent call last):
[2m[36m(pid=15991)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=15991)[0m     self._entrypoint()
[2m[36m(pid=15991)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=15991)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=15991)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=15991)[0m     output = fn()
[2m[36m(pid=15991)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=15991)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=15991)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=15991)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=15991)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=15991)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=15991)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=15991)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=15991)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=15991)[0m Exception in thread Thread-2:
[2m[36m(pid=15991)[0m Traceback (most recent call last):
[2m[36m(pid=15991)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=15991)[0m     self.run()
[2m[36m(pid=15991)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=15991)[0m     raise e
[2m[36m(pid=15991)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=15991)[0m     self._entrypoint()
[2m[36m(pid=15991)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=15991)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=15991)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=15991)[0m     output = fn()
[2m[36m(pid=15991)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=15991)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=15991)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=15991)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=15991)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=15991)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=15991)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=15991)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=15991)[0m ValueError: The parameter loc has invalid values
2021-04-30 17:22:37,602	ERROR trial_runner.py:732 -- Trial train_func_7599e_00035: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=15991, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=15991, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=19902)[0m 2021-04-30 18:06:10,927	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=19902)[0m Traceback (most recent call last):
[2m[36m(pid=19902)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=19902)[0m     self._entrypoint()
[2m[36m(pid=19902)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=19902)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=19902)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=19902)[0m     output = fn()
[2m[36m(pid=19902)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=19902)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=19902)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=19902)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=19902)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=19902)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=19902)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=19902)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=19902)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=19902)[0m Exception in thread Thread-2:
[2m[36m(pid=19902)[0m Traceback (most recent call last):
[2m[36m(pid=19902)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=19902)[0m     self.run()
[2m[36m(pid=19902)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=19902)[0m     raise e
[2m[36m(pid=19902)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=19902)[0m     self._entrypoint()
[2m[36m(pid=19902)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=19902)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=19902)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=19902)[0m     output = fn()
[2m[36m(pid=19902)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=19902)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=19902)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=19902)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=19902)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=19902)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=19902)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=19902)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=19902)[0m ValueError: The parameter loc has invalid values
2021-04-30 18:06:11,117	ERROR trial_runner.py:732 -- Trial train_func_7599e_00039: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=19902, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=19902, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=21241)[0m 2021-04-30 18:20:57,741	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=21241)[0m Traceback (most recent call last):
[2m[36m(pid=21241)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=21241)[0m     self._entrypoint()
[2m[36m(pid=21241)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=21241)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=21241)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=21241)[0m     output = fn()
[2m[36m(pid=21241)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=21241)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=21241)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=21241)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=21241)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=21241)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=21241)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=21241)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=21241)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=21241)[0m Exception in thread Thread-2:
[2m[36m(pid=21241)[0m Traceback (most recent call last):
[2m[36m(pid=21241)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=21241)[0m     self.run()
[2m[36m(pid=21241)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=21241)[0m     raise e
[2m[36m(pid=21241)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=21241)[0m     self._entrypoint()
[2m[36m(pid=21241)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=21241)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=21241)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=21241)[0m     output = fn()
[2m[36m(pid=21241)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=21241)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=21241)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=21241)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=21241)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=21241)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=21241)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=21241)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=21241)[0m ValueError: The parameter loc has invalid values
2021-04-30 18:20:57,797	ERROR trial_runner.py:732 -- Trial train_func_7599e_00041: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=21241, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=21241, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=21305)[0m 2021-04-30 18:21:20,118	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=21305)[0m Traceback (most recent call last):
[2m[36m(pid=21305)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=21305)[0m     self._entrypoint()
[2m[36m(pid=21305)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=21305)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=21305)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=21305)[0m     output = fn()
[2m[36m(pid=21305)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=21305)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=21305)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=21305)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=21305)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=21305)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=21305)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=21305)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=21305)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=21305)[0m Exception in thread Thread-2:
[2m[36m(pid=21305)[0m Traceback (most recent call last):
[2m[36m(pid=21305)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=21305)[0m     self.run()
[2m[36m(pid=21305)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=21305)[0m     raise e
[2m[36m(pid=21305)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=21305)[0m     self._entrypoint()
[2m[36m(pid=21305)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=21305)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=21305)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=21305)[0m     output = fn()
[2m[36m(pid=21305)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=21305)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=21305)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=21305)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=21305)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=21305)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=21305)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=21305)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=21305)[0m ValueError: The parameter loc has invalid values
2021-04-30 18:21:20,288	ERROR trial_runner.py:732 -- Trial train_func_7599e_00042: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=21305, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=21305, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=21362)[0m 2021-04-30 18:21:43,137	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=21362)[0m Traceback (most recent call last):
[2m[36m(pid=21362)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=21362)[0m     self._entrypoint()
[2m[36m(pid=21362)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=21362)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=21362)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=21362)[0m     output = fn()
[2m[36m(pid=21362)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=21362)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=21362)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=21362)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=21362)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=21362)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=21362)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=21362)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=21362)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=21362)[0m Exception in thread Thread-2:
[2m[36m(pid=21362)[0m Traceback (most recent call last):
[2m[36m(pid=21362)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=21362)[0m     self.run()
[2m[36m(pid=21362)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=21362)[0m     raise e
[2m[36m(pid=21362)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=21362)[0m     self._entrypoint()
[2m[36m(pid=21362)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=21362)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=21362)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=21362)[0m     output = fn()
[2m[36m(pid=21362)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=21362)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=21362)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=21362)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=21362)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=21362)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=21362)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=21362)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=21362)[0m ValueError: The parameter loc has invalid values
2021-04-30 18:21:43,302	ERROR trial_runner.py:732 -- Trial train_func_7599e_00043: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=21362, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=21362, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=21416)[0m 2021-04-30 18:22:06,664	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=21416)[0m Traceback (most recent call last):
[2m[36m(pid=21416)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=21416)[0m     self._entrypoint()
[2m[36m(pid=21416)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=21416)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=21416)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=21416)[0m     output = fn()
[2m[36m(pid=21416)[0m   File "grid_search_warm_up.py", line 103, in train_func
[2m[36m(pid=21416)[0m     elbos, _, _ = vae.loss(x_hat_eval, eval_batch,p_mu,p_logvar,d_mu,d_logvar, alpha_warm_up =alpha_warm_up[k])#
[2m[36m(pid=21416)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=21416)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=21416)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=21416)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=21416)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=21416)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=21416)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=21416)[0m Exception in thread Thread-2:
[2m[36m(pid=21416)[0m Traceback (most recent call last):
[2m[36m(pid=21416)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=21416)[0m     self.run()
[2m[36m(pid=21416)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=21416)[0m     raise e
[2m[36m(pid=21416)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=21416)[0m     self._entrypoint()
[2m[36m(pid=21416)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=21416)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=21416)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=21416)[0m     output = fn()
[2m[36m(pid=21416)[0m   File "grid_search_warm_up.py", line 103, in train_func
[2m[36m(pid=21416)[0m     elbos, _, _ = vae.loss(x_hat_eval, eval_batch,p_mu,p_logvar,d_mu,d_logvar, alpha_warm_up =alpha_warm_up[k])#
[2m[36m(pid=21416)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=21416)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=21416)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=21416)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=21416)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=21416)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=21416)[0m ValueError: The parameter loc has invalid values
2021-04-30 18:22:06,715	ERROR trial_runner.py:732 -- Trial train_func_7599e_00044: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=21416, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=21416, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 103, in train_func
    elbos, _, _ = vae.loss(x_hat_eval, eval_batch,p_mu,p_logvar,d_mu,d_logvar, alpha_warm_up =alpha_warm_up[k])#
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=4888)[0m 2021-04-30 21:31:37,739	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=4888)[0m Traceback (most recent call last):
[2m[36m(pid=4888)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=4888)[0m     self._entrypoint()
[2m[36m(pid=4888)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=4888)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=4888)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=4888)[0m     output = fn()
[2m[36m(pid=4888)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=4888)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=4888)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=4888)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=4888)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=4888)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=4888)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=4888)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=4888)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=4888)[0m Exception in thread Thread-2:
[2m[36m(pid=4888)[0m Traceback (most recent call last):
[2m[36m(pid=4888)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=4888)[0m     self.run()
[2m[36m(pid=4888)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=4888)[0m     raise e
[2m[36m(pid=4888)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=4888)[0m     self._entrypoint()
[2m[36m(pid=4888)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=4888)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=4888)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=4888)[0m     output = fn()
[2m[36m(pid=4888)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=4888)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=4888)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=4888)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=4888)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=4888)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=4888)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=4888)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=4888)[0m ValueError: The parameter loc has invalid values
2021-04-30 21:31:37,993	ERROR trial_runner.py:732 -- Trial train_func_7599e_00057: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=4888, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=4888, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=5343)[0m 2021-04-30 21:32:01,558	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=5343)[0m Traceback (most recent call last):
[2m[36m(pid=5343)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=5343)[0m     self._entrypoint()
[2m[36m(pid=5343)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=5343)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=5343)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=5343)[0m     output = fn()
[2m[36m(pid=5343)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=5343)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=5343)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=5343)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=5343)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=5343)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=5343)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=5343)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=5343)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=5343)[0m Exception in thread Thread-2:
[2m[36m(pid=5343)[0m Traceback (most recent call last):
[2m[36m(pid=5343)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=5343)[0m     self.run()
[2m[36m(pid=5343)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=5343)[0m     raise e
[2m[36m(pid=5343)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=5343)[0m     self._entrypoint()
[2m[36m(pid=5343)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=5343)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=5343)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=5343)[0m     output = fn()
[2m[36m(pid=5343)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=5343)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=5343)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=5343)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=5343)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=5343)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=5343)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=5343)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=5343)[0m ValueError: The parameter loc has invalid values
2021-04-30 21:32:01,687	ERROR trial_runner.py:732 -- Trial train_func_7599e_00058: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=5343, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=5343, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=6298)[0m 2021-04-30 21:47:35,601	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=6298)[0m Traceback (most recent call last):
[2m[36m(pid=6298)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=6298)[0m     self._entrypoint()
[2m[36m(pid=6298)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=6298)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=6298)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=6298)[0m     output = fn()
[2m[36m(pid=6298)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=6298)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=6298)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=6298)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=6298)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=6298)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=6298)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=6298)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=6298)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=6298)[0m Exception in thread Thread-2:
[2m[36m(pid=6298)[0m Traceback (most recent call last):
[2m[36m(pid=6298)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=6298)[0m     self.run()
[2m[36m(pid=6298)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=6298)[0m     raise e
[2m[36m(pid=6298)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=6298)[0m     self._entrypoint()
[2m[36m(pid=6298)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=6298)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=6298)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=6298)[0m     output = fn()
[2m[36m(pid=6298)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=6298)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=6298)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=6298)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=6298)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=6298)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=6298)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=6298)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=6298)[0m ValueError: The parameter loc has invalid values
2021-04-30 21:47:35,735	ERROR trial_runner.py:732 -- Trial train_func_7599e_00060: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=6298, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=6298, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=6345)[0m 2021-04-30 21:47:59,075	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=6345)[0m Traceback (most recent call last):
[2m[36m(pid=6345)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=6345)[0m     self._entrypoint()
[2m[36m(pid=6345)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=6345)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=6345)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=6345)[0m     output = fn()
[2m[36m(pid=6345)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=6345)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=6345)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=6345)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=6345)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=6345)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=6345)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=6345)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=6345)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=6345)[0m Exception in thread Thread-2:
[2m[36m(pid=6345)[0m Traceback (most recent call last):
[2m[36m(pid=6345)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=6345)[0m     self.run()
[2m[36m(pid=6345)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=6345)[0m     raise e
[2m[36m(pid=6345)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=6345)[0m     self._entrypoint()
[2m[36m(pid=6345)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=6345)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=6345)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=6345)[0m     output = fn()
[2m[36m(pid=6345)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=6345)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=6345)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=6345)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=6345)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=6345)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=6345)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=6345)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=6345)[0m ValueError: The parameter loc has invalid values
2021-04-30 21:47:59,117	ERROR trial_runner.py:732 -- Trial train_func_7599e_00061: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=6345, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=6345, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=8229)[0m 2021-04-30 22:18:47,356	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=8229)[0m Traceback (most recent call last):
[2m[36m(pid=8229)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=8229)[0m     self._entrypoint()
[2m[36m(pid=8229)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=8229)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=8229)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=8229)[0m     output = fn()
[2m[36m(pid=8229)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=8229)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=8229)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=8229)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=8229)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=8229)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=8229)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=8229)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=8229)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=8229)[0m Exception in thread Thread-2:
[2m[36m(pid=8229)[0m Traceback (most recent call last):
[2m[36m(pid=8229)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=8229)[0m     self.run()
[2m[36m(pid=8229)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=8229)[0m     raise e
[2m[36m(pid=8229)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=8229)[0m     self._entrypoint()
[2m[36m(pid=8229)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=8229)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=8229)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=8229)[0m     output = fn()
[2m[36m(pid=8229)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=8229)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=8229)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=8229)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=8229)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=8229)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=8229)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=8229)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=8229)[0m ValueError: The parameter loc has invalid values
2021-04-30 22:18:47,426	ERROR trial_runner.py:732 -- Trial train_func_7599e_00064: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=8229, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=8229, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=15800)[0m 2021-05-01 00:21:58,131	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=15800)[0m Traceback (most recent call last):
[2m[36m(pid=15800)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=15800)[0m     self._entrypoint()
[2m[36m(pid=15800)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=15800)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=15800)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=15800)[0m     output = fn()
[2m[36m(pid=15800)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=15800)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=15800)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=15800)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=15800)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=15800)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=15800)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=15800)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=15800)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=15800)[0m Exception in thread Thread-2:
[2m[36m(pid=15800)[0m Traceback (most recent call last):
[2m[36m(pid=15800)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=15800)[0m     self.run()
[2m[36m(pid=15800)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=15800)[0m     raise e
[2m[36m(pid=15800)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=15800)[0m     self._entrypoint()
[2m[36m(pid=15800)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=15800)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=15800)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=15800)[0m     output = fn()
[2m[36m(pid=15800)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=15800)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=15800)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=15800)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=15800)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=15800)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=15800)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=15800)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=15800)[0m ValueError: The parameter loc has invalid values
2021-05-01 00:21:58,323	ERROR trial_runner.py:732 -- Trial train_func_7599e_00073: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=15800, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=15800, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=16767)[0m 2021-05-01 00:37:43,160	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=16767)[0m Traceback (most recent call last):
[2m[36m(pid=16767)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=16767)[0m     self._entrypoint()
[2m[36m(pid=16767)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=16767)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=16767)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=16767)[0m     output = fn()
[2m[36m(pid=16767)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=16767)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=16767)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=16767)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=16767)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=16767)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=16767)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=16767)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=16767)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=16767)[0m Exception in thread Thread-2:
[2m[36m(pid=16767)[0m Traceback (most recent call last):
[2m[36m(pid=16767)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=16767)[0m     self.run()
[2m[36m(pid=16767)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=16767)[0m     raise e
[2m[36m(pid=16767)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=16767)[0m     self._entrypoint()
[2m[36m(pid=16767)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=16767)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=16767)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=16767)[0m     output = fn()
[2m[36m(pid=16767)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=16767)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=16767)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=16767)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=16767)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=16767)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=16767)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=16767)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=16767)[0m ValueError: The parameter loc has invalid values
2021-05-01 00:37:43,312	ERROR trial_runner.py:732 -- Trial train_func_7599e_00075: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=16767, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=16767, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=16820)[0m 2021-05-01 00:38:11,533	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=16820)[0m Traceback (most recent call last):
[2m[36m(pid=16820)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=16820)[0m     self._entrypoint()
[2m[36m(pid=16820)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=16820)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=16820)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=16820)[0m     output = fn()
[2m[36m(pid=16820)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=16820)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=16820)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=16820)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=16820)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=16820)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=16820)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=16820)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=16820)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=16820)[0m Exception in thread Thread-2:
[2m[36m(pid=16820)[0m Traceback (most recent call last):
[2m[36m(pid=16820)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=16820)[0m     self.run()
[2m[36m(pid=16820)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=16820)[0m     raise e
[2m[36m(pid=16820)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
2021-05-01 00:38:11,592	ERROR trial_runner.py:732 -- Trial train_func_7599e_00076: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=16820, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=16820, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[36m(pid=16820)[0m     self._entrypoint()
[2m[36m(pid=16820)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=16820)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=16820)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=16820)[0m     output = fn()
[2m[36m(pid=16820)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=16820)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=16820)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=16820)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=16820)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=16820)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=16820)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=16820)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=16820)[0m ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=19681)[0m 2021-05-01 01:25:28,481	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=19681)[0m Traceback (most recent call last):
[2m[36m(pid=19681)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=19681)[0m     self._entrypoint()
[2m[36m(pid=19681)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=19681)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=19681)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=19681)[0m     output = fn()
[2m[36m(pid=19681)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=19681)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=19681)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=19681)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=19681)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=19681)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=19681)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=19681)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=19681)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=19681)[0m Exception in thread Thread-2:
[2m[36m(pid=19681)[0m Traceback (most recent call last):
[2m[36m(pid=19681)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=19681)[0m     self.run()
[2m[36m(pid=19681)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=19681)[0m     raise e
[2m[36m(pid=19681)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=19681)[0m     self._entrypoint()
[2m[36m(pid=19681)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=19681)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=19681)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=19681)[0m     output = fn()
[2m[36m(pid=19681)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=19681)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=19681)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=19681)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=19681)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=19681)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=19681)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=19681)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=19681)[0m ValueError: The parameter loc has invalid values
2021-05-01 01:25:28,707	ERROR trial_runner.py:732 -- Trial train_func_7599e_00080: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=19681, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=19681, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=25670)[0m 2021-05-01 02:58:45,903	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=25670)[0m Traceback (most recent call last):
[2m[36m(pid=25670)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=25670)[0m     self._entrypoint()
[2m[36m(pid=25670)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=25670)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=25670)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=25670)[0m     output = fn()
[2m[36m(pid=25670)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=25670)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=25670)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=25670)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=25670)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=25670)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=25670)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=25670)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=25670)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=25670)[0m Exception in thread Thread-2:
[2m[36m(pid=25670)[0m Traceback (most recent call last):
[2m[36m(pid=25670)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=25670)[0m     self.run()
[2m[36m(pid=25670)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=25670)[0m     raise e
[2m[36m(pid=25670)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=25670)[0m     self._entrypoint()
[2m[36m(pid=25670)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=25670)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=25670)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=25670)[0m     output = fn()
[2m[36m(pid=25670)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=25670)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=25670)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=25670)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=25670)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=25670)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=25670)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=25670)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=25670)[0m ValueError: The parameter loc has invalid values
2021-05-01 02:58:45,961	ERROR trial_runner.py:732 -- Trial train_func_7599e_00087: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=25670, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=25670, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=25726)[0m 2021-05-01 02:59:09,999	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=25726)[0m Traceback (most recent call last):
[2m[36m(pid=25726)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=25726)[0m     self._entrypoint()
[2m[36m(pid=25726)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=25726)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=25726)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=25726)[0m     output = fn()
[2m[36m(pid=25726)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=25726)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=25726)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=25726)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=25726)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=25726)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=25726)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=25726)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=25726)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=25726)[0m Exception in thread Thread-2:
[2m[36m(pid=25726)[0m Traceback (most recent call last):
[2m[36m(pid=25726)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=25726)[0m     self.run()
[2m[36m(pid=25726)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=25726)[0m     raise e
[2m[36m(pid=25726)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=25726)[0m     self._entrypoint()
[2m[36m(pid=25726)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=25726)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=25726)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=25726)[0m     output = fn()
[2m[36m(pid=25726)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=25726)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=25726)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=25726)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=25726)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=25726)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=25726)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=25726)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=25726)[0m ValueError: The parameter loc has invalid values
2021-05-01 02:59:10,125	ERROR trial_runner.py:732 -- Trial train_func_7599e_00088: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=25726, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=25726, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=26751)[0m 2021-05-01 03:15:14,664	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=26751)[0m Traceback (most recent call last):
[2m[36m(pid=26751)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=26751)[0m     self._entrypoint()
[2m[36m(pid=26751)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=26751)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=26751)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=26751)[0m     output = fn()
[2m[36m(pid=26751)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=26751)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=26751)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=26751)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=26751)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=26751)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=26751)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=26751)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=26751)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=26751)[0m Exception in thread Thread-2:
[2m[36m(pid=26751)[0m Traceback (most recent call last):
[2m[36m(pid=26751)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=26751)[0m     self.run()
[2m[36m(pid=26751)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=26751)[0m     raise e
[2m[36m(pid=26751)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=26751)[0m     self._entrypoint()
[2m[36m(pid=26751)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=26751)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=26751)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=26751)[0m     output = fn()
[2m[36m(pid=26751)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=26751)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=26751)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=26751)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=26751)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=26751)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=26751)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=26751)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=26751)[0m ValueError: The parameter loc has invalid values
2021-05-01 03:15:14,804	ERROR trial_runner.py:732 -- Trial train_func_7599e_00090: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=26751, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=26751, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=27897)[0m 2021-05-01 03:31:14,575	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=27897)[0m Traceback (most recent call last):
[2m[36m(pid=27897)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=27897)[0m     self._entrypoint()
[2m[36m(pid=27897)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=27897)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=27897)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=27897)[0m     output = fn()
[2m[36m(pid=27897)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=27897)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=27897)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=27897)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=27897)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=27897)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=27897)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=27897)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=27897)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=27897)[0m Exception in thread Thread-2:
[2m[36m(pid=27897)[0m Traceback (most recent call last):
[2m[36m(pid=27897)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=27897)[0m     self.run()
[2m[36m(pid=27897)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=27897)[0m     raise e
[2m[36m(pid=27897)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=27897)[0m     self._entrypoint()
[2m[36m(pid=27897)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=27897)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=27897)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=27897)[0m     output = fn()
[2m[36m(pid=27897)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=27897)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=27897)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=27897)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=27897)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=27897)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=27897)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=27897)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=27897)[0m ValueError: The parameter loc has invalid values
2021-05-01 03:31:14,675	ERROR trial_runner.py:732 -- Trial train_func_7599e_00092: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=27897, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=27897, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=27943)[0m 2021-05-01 03:40:27,432	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=27943)[0m Traceback (most recent call last):
[2m[36m(pid=27943)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=27943)[0m     self._entrypoint()
[2m[36m(pid=27943)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=27943)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=27943)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=27943)[0m     output = fn()
[2m[36m(pid=27943)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=27943)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=27943)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=27943)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=27943)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=27943)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=27943)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=27943)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=27943)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=27943)[0m Exception in thread Thread-2:
[2m[36m(pid=27943)[0m Traceback (most recent call last):
[2m[36m(pid=27943)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=27943)[0m     self.run()
[2m[36m(pid=27943)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=27943)[0m     raise e
[2m[36m(pid=27943)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
2021-05-01 03:40:27,478	ERROR trial_runner.py:732 -- Trial train_func_7599e_00093: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=27943, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=27943, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[36m(pid=27943)[0m     self._entrypoint()
[2m[36m(pid=27943)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=27943)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=27943)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=27943)[0m     output = fn()
[2m[36m(pid=27943)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=27943)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=27943)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=27943)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=27943)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=27943)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=27943)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=27943)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=27943)[0m ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=28514)[0m 2021-05-01 03:40:56,633	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=28514)[0m Traceback (most recent call last):
[2m[36m(pid=28514)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=28514)[0m     self._entrypoint()
[2m[36m(pid=28514)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=28514)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=28514)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=28514)[0m     output = fn()
[2m[36m(pid=28514)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=28514)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=28514)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=28514)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=28514)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=28514)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=28514)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=28514)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=28514)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=28514)[0m Exception in thread Thread-2:
[2m[36m(pid=28514)[0m Traceback (most recent call last):
[2m[36m(pid=28514)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=28514)[0m     self.run()
[2m[36m(pid=28514)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=28514)[0m     raise e
[2m[36m(pid=28514)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=28514)[0m     self._entrypoint()
[2m[36m(pid=28514)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=28514)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=28514)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=28514)[0m     output = fn()
[2m[36m(pid=28514)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=28514)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=28514)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=28514)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=28514)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=28514)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=28514)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=28514)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=28514)[0m ValueError: The parameter loc has invalid values
2021-05-01 03:40:56,812	ERROR trial_runner.py:732 -- Trial train_func_7599e_00094: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=28514, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=28514, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=30622)[0m 2021-05-01 04:12:46,839	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=30622)[0m Traceback (most recent call last):
[2m[36m(pid=30622)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=30622)[0m     self._entrypoint()
[2m[36m(pid=30622)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=30622)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=30622)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=30622)[0m     output = fn()
[2m[36m(pid=30622)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=30622)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=30622)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=30622)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=30622)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=30622)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=30622)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=30622)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=30622)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=30622)[0m Exception in thread Thread-2:
[2m[36m(pid=30622)[0m Traceback (most recent call last):
[2m[36m(pid=30622)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=30622)[0m     self.run()
[2m[36m(pid=30622)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=30622)[0m     raise e
[2m[36m(pid=30622)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=30622)[0m     self._entrypoint()
[2m[36m(pid=30622)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=30622)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=30622)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=30622)[0m     output = fn()
[2m[36m(pid=30622)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=30622)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=30622)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=30622)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=30622)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=30622)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=30622)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=30622)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=30622)[0m ValueError: The parameter loc has invalid values
2021-05-01 04:12:47,011	ERROR trial_runner.py:732 -- Trial train_func_7599e_00097: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=30622, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=30622, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
2021-05-01 04:29:03,328	ERROR trial_runner.py:732 -- Trial train_func_7599e_00099: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=31612, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=31612, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[36m(pid=31612)[0m 2021-05-01 04:29:03,287	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=31612)[0m Traceback (most recent call last):
[2m[36m(pid=31612)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=31612)[0m     self._entrypoint()
[2m[36m(pid=31612)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=31612)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=31612)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=31612)[0m     output = fn()
[2m[36m(pid=31612)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=31612)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=31612)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=31612)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=31612)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=31612)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=31612)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=31612)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=31612)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=31612)[0m Exception in thread Thread-2:
[2m[36m(pid=31612)[0m Traceback (most recent call last):
[2m[36m(pid=31612)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=31612)[0m     self.run()
[2m[36m(pid=31612)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=31612)[0m     raise e
[2m[36m(pid=31612)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=31612)[0m     self._entrypoint()
[2m[36m(pid=31612)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=31612)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=31612)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=31612)[0m     output = fn()
[2m[36m(pid=31612)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=31612)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=31612)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=31612)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=31612)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=31612)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=31612)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=31612)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=31612)[0m ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=31662)[0m 2021-05-01 04:44:02,516	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=31662)[0m Traceback (most recent call last):
[2m[36m(pid=31662)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=31662)[0m     self._entrypoint()
[2m[36m(pid=31662)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=31662)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=31662)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=31662)[0m     output = fn()
[2m[36m(pid=31662)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=31662)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=31662)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=31662)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=31662)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=31662)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=31662)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=31662)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=31662)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=31662)[0m Exception in thread Thread-2:
[2m[36m(pid=31662)[0m Traceback (most recent call last):
[2m[36m(pid=31662)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=31662)[0m     self.run()
[2m[36m(pid=31662)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=31662)[0m     raise e
[2m[36m(pid=31662)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=31662)[0m     self._entrypoint()
[2m[36m(pid=31662)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=31662)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=31662)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=31662)[0m     output = fn()
[2m[36m(pid=31662)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=31662)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=31662)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=31662)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=31662)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=31662)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=31662)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=31662)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=31662)[0m ValueError: The parameter loc has invalid values
2021-05-01 04:44:02,629	ERROR trial_runner.py:732 -- Trial train_func_7599e_00100: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=31662, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=31662, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=32559)[0m 2021-05-01 04:44:31,381	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=32559)[0m Traceback (most recent call last):
[2m[36m(pid=32559)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=32559)[0m     self._entrypoint()
[2m[36m(pid=32559)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=32559)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=32559)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=32559)[0m     output = fn()
[2m[36m(pid=32559)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=32559)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=32559)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=32559)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=32559)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=32559)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=32559)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=32559)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=32559)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=32559)[0m Exception in thread Thread-2:
[2m[36m(pid=32559)[0m Traceback (most recent call last):
[2m[36m(pid=32559)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=32559)[0m     self.run()
[2m[36m(pid=32559)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=32559)[0m     raise e
[2m[36m(pid=32559)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=32559)[0m     self._entrypoint()
[2m[36m(pid=32559)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=32559)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=32559)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=32559)[0m     output = fn()
[2m[36m(pid=32559)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=32559)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=32559)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=32559)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=32559)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=32559)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=32559)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=32559)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=32559)[0m ValueError: The parameter loc has invalid values
2021-05-01 04:44:31,513	ERROR trial_runner.py:732 -- Trial train_func_7599e_00101: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=32559, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=32559, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
2021-05-01 05:11:47,444	ERROR trial_runner.py:732 -- Trial train_func_7599e_00103: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=1134, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=1134, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[36m(pid=1134)[0m 2021-05-01 05:11:47,385	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=1134)[0m Traceback (most recent call last):
[2m[36m(pid=1134)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=1134)[0m     self._entrypoint()
[2m[36m(pid=1134)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=1134)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=1134)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=1134)[0m     output = fn()
[2m[36m(pid=1134)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=1134)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=1134)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=1134)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=1134)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=1134)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=1134)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=1134)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=1134)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=1134)[0m Exception in thread Thread-2:
[2m[36m(pid=1134)[0m Traceback (most recent call last):
[2m[36m(pid=1134)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=1134)[0m     self.run()
[2m[36m(pid=1134)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=1134)[0m     raise e
[2m[36m(pid=1134)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=1134)[0m     self._entrypoint()
[2m[36m(pid=1134)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=1134)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=1134)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=1134)[0m     output = fn()
[2m[36m(pid=1134)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=1134)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=1134)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=1134)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=1134)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=1134)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=1134)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=1134)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=1134)[0m ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=2869)[0m 2021-05-01 05:27:56,463	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=2869)[0m Traceback (most recent call last):
[2m[36m(pid=2869)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=2869)[0m     self._entrypoint()
[2m[36m(pid=2869)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=2869)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=2869)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=2869)[0m     output = fn()
[2m[36m(pid=2869)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=2869)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=2869)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=2869)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=2869)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=2869)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=2869)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=2869)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=2869)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=2869)[0m Exception in thread Thread-2:
[2m[36m(pid=2869)[0m Traceback (most recent call last):
[2m[36m(pid=2869)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=2869)[0m     self.run()
[2m[36m(pid=2869)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=2869)[0m     raise e
[2m[36m(pid=2869)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=2869)[0m     self._entrypoint()
[2m[36m(pid=2869)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=2869)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=2869)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=2869)[0m     output = fn()
[2m[36m(pid=2869)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=2869)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=2869)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=2869)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=2869)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=2869)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=2869)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=2869)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=2869)[0m ValueError: The parameter loc has invalid values
2021-05-01 05:27:56,539	ERROR trial_runner.py:732 -- Trial train_func_7599e_00105: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=2869, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=2869, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=4970)[0m 2021-05-01 06:00:03,834	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=4970)[0m Traceback (most recent call last):
[2m[36m(pid=4970)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=4970)[0m     self._entrypoint()
[2m[36m(pid=4970)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=4970)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=4970)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=4970)[0m     output = fn()
[2m[36m(pid=4970)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=4970)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=4970)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=4970)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=4970)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=4970)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=4970)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=4970)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=4970)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=4970)[0m Exception in thread Thread-2:
[2m[36m(pid=4970)[0m Traceback (most recent call last):
[2m[36m(pid=4970)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=4970)[0m     self.run()
[2m[36m(pid=4970)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=4970)[0m     raise e
[2m[36m(pid=4970)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=4970)[0m     self._entrypoint()
[2m[36m(pid=4970)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=4970)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=4970)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=4970)[0m     output = fn()
[2m[36m(pid=4970)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=4970)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=4970)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=4970)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=4970)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=4970)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=4970)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=4970)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=4970)[0m ValueError: The parameter loc has invalid values
2021-05-01 06:00:03,947	ERROR trial_runner.py:732 -- Trial train_func_7599e_00108: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=4970, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=4970, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=6016)[0m 2021-05-01 06:16:31,800	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=6016)[0m Traceback (most recent call last):
[2m[36m(pid=6016)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=6016)[0m     self._entrypoint()
[2m[36m(pid=6016)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=6016)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=6016)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=6016)[0m     output = fn()
[2m[36m(pid=6016)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=6016)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=6016)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=6016)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=6016)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=6016)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=6016)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=6016)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=6016)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=6016)[0m Exception in thread Thread-2:
[2m[36m(pid=6016)[0m Traceback (most recent call last):
[2m[36m(pid=6016)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=6016)[0m     self.run()
[2m[36m(pid=6016)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=6016)[0m     raise e
[2m[36m(pid=6016)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=6016)[0m     self._entrypoint()
[2m[36m(pid=6016)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=6016)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=6016)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=6016)[0m     output = fn()
[2m[36m(pid=6016)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=6016)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=6016)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=6016)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=6016)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=6016)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=6016)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=6016)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=6016)[0m ValueError: The parameter loc has invalid values
2021-05-01 06:16:31,999	ERROR trial_runner.py:732 -- Trial train_func_7599e_00110: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=6016, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=6016, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=7959)[0m 2021-05-01 06:53:14,385	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=7959)[0m Traceback (most recent call last):
[2m[36m(pid=7959)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=7959)[0m     self._entrypoint()
[2m[36m(pid=7959)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=7959)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=7959)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=7959)[0m     output = fn()
[2m[36m(pid=7959)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=7959)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=7959)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=7959)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=7959)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=7959)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=7959)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=7959)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=7959)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=7959)[0m Exception in thread Thread-2:
[2m[36m(pid=7959)[0m Traceback (most recent call last):
[2m[36m(pid=7959)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=7959)[0m     self.run()
[2m[36m(pid=7959)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=7959)[0m     raise e
[2m[36m(pid=7959)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=7959)[0m     self._entrypoint()
[2m[36m(pid=7959)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=7959)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=7959)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=7959)[0m     output = fn()
[2m[36m(pid=7959)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=7959)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=7959)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=7959)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=7959)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=7959)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=7959)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=7959)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=7959)[0m ValueError: The parameter loc has invalid values
2021-05-01 06:53:14,534	ERROR trial_runner.py:732 -- Trial train_func_7599e_00113: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=7959, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=7959, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
2021-05-01 07:25:50,826	ERROR trial_runner.py:732 -- Trial train_func_7599e_00116: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=10254, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=10254, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[36m(pid=10254)[0m 2021-05-01 07:25:50,794	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=10254)[0m Traceback (most recent call last):
[2m[36m(pid=10254)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=10254)[0m     self._entrypoint()
[2m[36m(pid=10254)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=10254)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=10254)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=10254)[0m     output = fn()
[2m[36m(pid=10254)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=10254)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=10254)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=10254)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=10254)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=10254)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=10254)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=10254)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=10254)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=10254)[0m Exception in thread Thread-2:
[2m[36m(pid=10254)[0m Traceback (most recent call last):
[2m[36m(pid=10254)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=10254)[0m     self.run()
[2m[36m(pid=10254)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=10254)[0m     raise e
[2m[36m(pid=10254)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=10254)[0m     self._entrypoint()
[2m[36m(pid=10254)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=10254)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=10254)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=10254)[0m     output = fn()
[2m[36m(pid=10254)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=10254)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=10254)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=10254)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=10254)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=10254)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=10254)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=10254)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=10254)[0m ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=10310)[0m 2021-05-01 07:26:58,657	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=10310)[0m Traceback (most recent call last):
[2m[36m(pid=10310)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=10310)[0m     self._entrypoint()
[2m[36m(pid=10310)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=10310)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=10310)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=10310)[0m     output = fn()
[2m[36m(pid=10310)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=10310)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=10310)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=10310)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=10310)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=10310)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=10310)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=10310)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=10310)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=10310)[0m Exception in thread Thread-2:
[2m[36m(pid=10310)[0m Traceback (most recent call last):
[2m[36m(pid=10310)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=10310)[0m     self.run()
[2m[36m(pid=10310)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=10310)[0m     raise e
[2m[36m(pid=10310)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=10310)[0m     self._entrypoint()
[2m[36m(pid=10310)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=10310)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=10310)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=10310)[0m     output = fn()
[2m[36m(pid=10310)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=10310)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=10310)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=10310)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=10310)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=10310)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=10310)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=10310)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=10310)[0m ValueError: The parameter loc has invalid values
2021-05-01 07:26:58,798	ERROR trial_runner.py:732 -- Trial train_func_7599e_00117: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=10310, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=10310, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=10397)[0m 2021-05-01 07:27:24,076	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=10397)[0m Traceback (most recent call last):
[2m[36m(pid=10397)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=10397)[0m     self._entrypoint()
[2m[36m(pid=10397)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=10397)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=10397)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=10397)[0m     output = fn()
[2m[36m(pid=10397)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=10397)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=10397)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=10397)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=10397)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=10397)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=10397)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=10397)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=10397)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=10397)[0m Exception in thread Thread-2:
[2m[36m(pid=10397)[0m Traceback (most recent call last):
[2m[36m(pid=10397)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=10397)[0m     self.run()
[2m[36m(pid=10397)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=10397)[0m     raise e
[2m[36m(pid=10397)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=10397)[0m     self._entrypoint()
[2m[36m(pid=10397)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=10397)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=10397)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=10397)[0m     output = fn()
[2m[36m(pid=10397)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=10397)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=10397)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=10397)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=10397)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=10397)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=10397)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=10397)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=10397)[0m ValueError: The parameter loc has invalid values
2021-05-01 07:27:24,293	ERROR trial_runner.py:732 -- Trial train_func_7599e_00118: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=10397, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=10397, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=11461)[0m 2021-05-01 07:44:37,745	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=11461)[0m Traceback (most recent call last):
[2m[36m(pid=11461)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=11461)[0m     self._entrypoint()
[2m[36m(pid=11461)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=11461)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=11461)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=11461)[0m     output = fn()
[2m[36m(pid=11461)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=11461)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=11461)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=11461)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=11461)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=11461)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=11461)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=11461)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=11461)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=11461)[0m Exception in thread Thread-2:
[2m[36m(pid=11461)[0m Traceback (most recent call last):
[2m[36m(pid=11461)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=11461)[0m     self.run()
[2m[36m(pid=11461)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=11461)[0m     raise e
[2m[36m(pid=11461)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=11461)[0m     self._entrypoint()
[2m[36m(pid=11461)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=11461)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=11461)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=11461)[0m     output = fn()
[2m[36m(pid=11461)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=11461)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=11461)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=11461)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=11461)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=11461)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=11461)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=11461)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=11461)[0m ValueError: The parameter loc has invalid values
2021-05-01 07:44:37,864	ERROR trial_runner.py:732 -- Trial train_func_7599e_00120: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=11461, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=11461, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=12525)[0m 2021-05-01 08:01:44,480	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=12525)[0m Traceback (most recent call last):
[2m[36m(pid=12525)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=12525)[0m     self._entrypoint()
[2m[36m(pid=12525)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=12525)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=12525)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=12525)[0m     output = fn()
[2m[36m(pid=12525)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=12525)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=12525)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=12525)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=12525)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=12525)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=12525)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=12525)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=12525)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=12525)[0m Exception in thread Thread-2:
[2m[36m(pid=12525)[0m Traceback (most recent call last):
[2m[36m(pid=12525)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=12525)[0m     self.run()
[2m[36m(pid=12525)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=12525)[0m     raise e
[2m[36m(pid=12525)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=12525)[0m     self._entrypoint()
[2m[36m(pid=12525)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=12525)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=12525)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=12525)[0m     output = fn()
[2m[36m(pid=12525)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=12525)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=12525)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=12525)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=12525)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=12525)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=12525)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=12525)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=12525)[0m ValueError: The parameter loc has invalid values
2021-05-01 08:01:44,562	ERROR trial_runner.py:732 -- Trial train_func_7599e_00122: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=12525, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=12525, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=12569)[0m 2021-05-01 08:02:10,333	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=12569)[0m Traceback (most recent call last):
[2m[36m(pid=12569)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=12569)[0m     self._entrypoint()
[2m[36m(pid=12569)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=12569)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=12569)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=12569)[0m     output = fn()
[2m[36m(pid=12569)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=12569)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=12569)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=12569)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=12569)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=12569)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=12569)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=12569)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=12569)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=12569)[0m Exception in thread Thread-2:
[2m[36m(pid=12569)[0m Traceback (most recent call last):
[2m[36m(pid=12569)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=12569)[0m     self.run()
[2m[36m(pid=12569)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=12569)[0m     raise e
[2m[36m(pid=12569)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=12569)[0m     self._entrypoint()
[2m[36m(pid=12569)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=12569)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=12569)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=12569)[0m     output = fn()
[2m[36m(pid=12569)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=12569)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=12569)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=12569)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=12569)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=12569)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=12569)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=12569)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=12569)[0m ValueError: The parameter loc has invalid values
2021-05-01 08:02:10,422	ERROR trial_runner.py:732 -- Trial train_func_7599e_00123: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=12569, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=12569, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=12628)[0m 2021-05-01 08:02:35,531	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=12628)[0m Traceback (most recent call last):
[2m[36m(pid=12628)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=12628)[0m     self._entrypoint()
[2m[36m(pid=12628)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=12628)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=12628)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=12628)[0m     output = fn()
[2m[36m(pid=12628)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=12628)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=12628)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=12628)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=12628)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=12628)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=12628)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=12628)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=12628)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=12628)[0m Exception in thread Thread-2:
[2m[36m(pid=12628)[0m Traceback (most recent call last):
[2m[36m(pid=12628)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=12628)[0m     self.run()
[2m[36m(pid=12628)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=12628)[0m     raise e
[2m[36m(pid=12628)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=12628)[0m     self._entrypoint()
[2m[36m(pid=12628)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=12628)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=12628)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=12628)[0m     output = fn()
[2m[36m(pid=12628)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=12628)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=12628)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=12628)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=12628)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=12628)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=12628)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=12628)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=12628)[0m ValueError: The parameter loc has invalid values
2021-05-01 08:02:35,654	ERROR trial_runner.py:732 -- Trial train_func_7599e_00124: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=12628, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=12628, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=12675)[0m 2021-05-01 08:03:00,833	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=12675)[0m Traceback (most recent call last):
[2m[36m(pid=12675)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=12675)[0m     self._entrypoint()
[2m[36m(pid=12675)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=12675)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=12675)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=12675)[0m     output = fn()
[2m[36m(pid=12675)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=12675)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=12675)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=12675)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=12675)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=12675)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=12675)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=12675)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=12675)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=12675)[0m Exception in thread Thread-2:
[2m[36m(pid=12675)[0m Traceback (most recent call last):
[2m[36m(pid=12675)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=12675)[0m     self.run()
[2m[36m(pid=12675)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=12675)[0m     raise e
[2m[36m(pid=12675)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=12675)[0m     self._entrypoint()
[2m[36m(pid=12675)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=12675)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=12675)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=12675)[0m     output = fn()
[2m[36m(pid=12675)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=12675)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=12675)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=12675)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=12675)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=12675)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=12675)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=12675)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=12675)[0m ValueError: The parameter loc has invalid values
2021-05-01 08:03:00,973	ERROR trial_runner.py:732 -- Trial train_func_7599e_00125: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=12675, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=12675, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=13846)[0m 2021-05-01 08:20:17,214	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=13846)[0m Traceback (most recent call last):
[2m[36m(pid=13846)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=13846)[0m     self._entrypoint()
[2m[36m(pid=13846)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=13846)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=13846)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=13846)[0m     output = fn()
[2m[36m(pid=13846)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=13846)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=13846)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=13846)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=13846)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=13846)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=13846)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=13846)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=13846)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=13846)[0m Exception in thread Thread-2:
[2m[36m(pid=13846)[0m Traceback (most recent call last):
[2m[36m(pid=13846)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=13846)[0m     self.run()
[2m[36m(pid=13846)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=13846)[0m     raise e
[2m[36m(pid=13846)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=13846)[0m     self._entrypoint()
[2m[36m(pid=13846)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=13846)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=13846)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=13846)[0m     output = fn()
[2m[36m(pid=13846)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=13846)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=13846)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=13846)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=13846)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=13846)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=13846)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=13846)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=13846)[0m ValueError: The parameter loc has invalid values
2021-05-01 08:20:17,349	ERROR trial_runner.py:732 -- Trial train_func_7599e_00127: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=13846, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=13846, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=15169)[0m 2021-05-01 08:37:39,615	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=15169)[0m Traceback (most recent call last):
[2m[36m(pid=15169)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=15169)[0m     self._entrypoint()
[2m[36m(pid=15169)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=15169)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=15169)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=15169)[0m     output = fn()
[2m[36m(pid=15169)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=15169)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=15169)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=15169)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=15169)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=15169)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=15169)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=15169)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=15169)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=15169)[0m Exception in thread Thread-2:
[2m[36m(pid=15169)[0m Traceback (most recent call last):
[2m[36m(pid=15169)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=15169)[0m     self.run()
[2m[36m(pid=15169)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=15169)[0m     raise e
[2m[36m(pid=15169)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=15169)[0m     self._entrypoint()
[2m[36m(pid=15169)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=15169)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=15169)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=15169)[0m     output = fn()
[2m[36m(pid=15169)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=15169)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=15169)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=15169)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=15169)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=15169)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=15169)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=15169)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=15169)[0m ValueError: The parameter loc has invalid values
2021-05-01 08:37:39,795	ERROR trial_runner.py:732 -- Trial train_func_7599e_00129: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=15169, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=15169, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[33m(raylet)[0m /zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/autoscaler/_private/cli_logger.py:57: FutureWarning: Not all Ray CLI dependencies were found. In Ray 1.4+, the Ray CLI, autoscaler, and dashboard will only be usable via `pip install 'ray[default]'`. Please update your install command.
[2m[33m(raylet)[0m   warnings.warn(
[2m[36m(pid=17457)[0m 2021-05-01 09:23:38,794	ERROR function_runner.py:254 -- Runner Thread raised error.
[2m[36m(pid=17457)[0m Traceback (most recent call last):
[2m[36m(pid=17457)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=17457)[0m     self._entrypoint()
[2m[36m(pid=17457)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=17457)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=17457)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=17457)[0m     output = fn()
[2m[36m(pid=17457)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=17457)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=17457)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=17457)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=17457)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=17457)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=17457)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=17457)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=17457)[0m ValueError: The parameter loc has invalid values
[2m[36m(pid=17457)[0m Exception in thread Thread-2:
[2m[36m(pid=17457)[0m Traceback (most recent call last):
[2m[36m(pid=17457)[0m   File "/appl/python/3.8.4/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2m[36m(pid=17457)[0m     self.run()
[2m[36m(pid=17457)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 267, in run
[2m[36m(pid=17457)[0m     raise e
[2m[36m(pid=17457)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
[2m[36m(pid=17457)[0m     self._entrypoint()
[2m[36m(pid=17457)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
[2m[36m(pid=17457)[0m     return self._trainable_func(self.config, self._status_reporter,
[2m[36m(pid=17457)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
[2m[36m(pid=17457)[0m     output = fn()
[2m[36m(pid=17457)[0m   File "grid_search_warm_up.py", line 94, in train_func
[2m[36m(pid=17457)[0m     loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
[2m[36m(pid=17457)[0m   File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
[2m[36m(pid=17457)[0m     p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
[2m[36m(pid=17457)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
[2m[36m(pid=17457)[0m     super(Normal, self).__init__(batch_shape, validate_args=validate_args)
[2m[36m(pid=17457)[0m   File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
[2m[36m(pid=17457)[0m     raise ValueError("The parameter {} has invalid values".format(param))
[2m[36m(pid=17457)[0m ValueError: The parameter loc has invalid values
2021-05-01 09:23:38,930	ERROR trial_runner.py:732 -- Trial train_func_7599e_00132: Error processing event.
Traceback (most recent call last):
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trial_runner.py", line 702, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/ray_trial_executor.py", line 686, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/worker.py", line 1481, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TuneError): [36mray::ImplicitFunc.train_buffered()[39m (pid=17457, ip=10.66.20.2)
  File "python/ray/_raylet.pyx", line 505, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 449, in ray._raylet.execute_task.function_executor
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/_private/function_manager.py", line 556, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 173, in train_buffered
    result = self.train()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/trainable.py", line 232, in train
    result = self.step()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 366, in step
    self._report_thread_runner_error(block=True)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 512, in _report_thread_runner_error
    raise TuneError(
ray.tune.error.TuneError: Trial raised an exception. Traceback:
[36mray::ImplicitFunc.train_buffered()[39m (pid=17457, ip=10.66.20.2)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 248, in run
    self._entrypoint()
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 315, in entrypoint
    return self._trainable_func(self.config, self._status_reporter,
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/function_runner.py", line 580, in _trainable_func
    output = fn()
  File "grid_search_warm_up.py", line 94, in train_func
    loss, rl, kl      = vae.loss(x_hat, batch,p_mu,p_logvar,d_mu,d_logvar,alpha_warm_up =alpha_warm_up[k])
  File "/zhome/45/c/127804/02460/Variational_proteins/HVAE_v2.py", line 183, in loss
    p = Normal(p_mu[i], p_logvar[i].mul(1/2).exp())
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/torch/distributions/distribution.py", line 53, in __init__
    raise ValueError("The parameter {} has invalid values".format(param))
ValueError: The parameter loc has invalid values
Traceback (most recent call last):
  File "grid_search_warm_up.py", line 165, in <module>
    analysis = tune.run(
  File "/zhome/45/c/127804/02460/python384/lib/python3.8/site-packages/ray/tune/tune.py", line 543, in run
    raise TuneError("Trials did not complete", incomplete_trials)
ray.tune.error.TuneError: ('Trials did not complete', [train_func_7599e_00018, train_func_7599e_00021, train_func_7599e_00023, train_func_7599e_00028, train_func_7599e_00032, train_func_7599e_00035, train_func_7599e_00039, train_func_7599e_00041, train_func_7599e_00042, train_func_7599e_00043, train_func_7599e_00044, train_func_7599e_00057, train_func_7599e_00058, train_func_7599e_00060, train_func_7599e_00061, train_func_7599e_00064, train_func_7599e_00073, train_func_7599e_00075, train_func_7599e_00076, train_func_7599e_00080, train_func_7599e_00087, train_func_7599e_00088, train_func_7599e_00090, train_func_7599e_00092, train_func_7599e_00093, train_func_7599e_00094, train_func_7599e_00097, train_func_7599e_00099, train_func_7599e_00100, train_func_7599e_00101, train_func_7599e_00103, train_func_7599e_00105, train_func_7599e_00108, train_func_7599e_00110, train_func_7599e_00113, train_func_7599e_00116, train_func_7599e_00117, train_func_7599e_00118, train_func_7599e_00120, train_func_7599e_00122, train_func_7599e_00123, train_func_7599e_00124, train_func_7599e_00125, train_func_7599e_00127, train_func_7599e_00129, train_func_7599e_00132])
